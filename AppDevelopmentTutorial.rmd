---
title: "Flask Tutorial Steps"
author: "Nakul Padalkar"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
## Prerequisite and Introduction
This tutorial provides a document for creating a generic flask machine learning application. I will use a sample dataset like breast cancer or house pricing for this walk through. Following steps will get you started to create an app environment from scratch on a windows platform. If you have a Mac, the commends will be little different and will require some modifications. Windows have `cmd` prompt while apple uses `terminal`. I will also try to include a Pycharm based procedure.

- Create a blank folder in your computer. Mine is located in E drive and named `ApplicationTutorial`.
- I am using a virtual environment and will generate it by opening `cmd` prompt in the same folder.
- `python -m venv .env` on the command prompt will create a virtual environment named `.venv` in the folder. 
- If you do not get any errors, then on Windows you will see a folder named `.venv`. In my case the folder path is `E:\ANLY 605\ApplicationTutorial\.venv\`.
- Let's Activate the python environment by using `.venv\scripts\activate`.
-  <span style="color:#CC0000">**Do not close the command prompt or terminal after this.**</span>

Now we want to install following packages, please stick to the versions given below, so you won't get errors. Copy the following text in to a file named `requirements.txt`. This file can be used to install all the required packages for this application. Keep it in the same place as your app. Use `pip install -r requirements.txt` to install the packages. 

`attrs==21.2.0`
`backcall==0.2.0`
`click==8.0.3`
`colorama==0.4.4`
`cycler==0.10.0`
`debugpy==1.5.1`
`decorator==5.1.0`
`entrypoints==0.3`
`Flask==2.0.2`
`ipykernel==6.4.2`
`ipython==7.28.0`
`ipython-genutils==0.2.0`
`itsdangerous==2.0.1`
`jedi==0.18.0`
`Jinja2==3.0.2`
`joblib==1.1.0`
`jsonschema==4.1.2`
`jupyter-client==7.0.6`
`jupyter-core==4.8.1`
`kaleido==0.2.1`
`kiwisolver==1.3.2`
`lightgbm==3.3.0`
`MarkupSafe==2.0.1`
`matplotlib==3.4.3`
`matplotlib-inline==0.1.3`
`nbformat==5.1.3`
`nest-asyncio==1.5.1`
`numpy==1.21.3`
`pandas==1.2.3`
`parso==0.8.2`
`pickleshare==0.7.5`
`Pillow==8.4.0`
`plotly==5.3.1`
`prompt-toolkit==3.0.21`
`Pygments==2.10.0`
`pyparsing==2.4.7`
`pyrsistent==0.18.0`
`python-dateutil==2.8.2`
`pytz==2021.3`
`pywin32==302`
`pyzmq==22.3.0`
`retrying==1.3.3`
`scikit-learn==1.0`
`scipy==1.7.1`
`seaborn==0.11.2`
`six==1.16.0`
`tenacity==8.0.1`
`threadpoolctl==3.0.0`
`tornado==6.1`
`traitlets==5.1.0`
`wcwidth==0.2.5`
`Werkzeug==2.0.2`
`xgboost==1.5.0`

## Start the application

Now go the flask website and go to [quick start minimal application](https://flask.palletsprojects.com/en/2.0.x/quickstart/#a-minimal-application). We are copying the example as it is to create a very simple flask application.

- In your `ApplicationTutorial` Folder create a folder named `app` (yes name should be all small letters) and in that folder create a python file names `app.py`.
- Copy the example from flask website in that file.
- Now go back to the command prompt and type `cd \app` hit enter and then type `flask run`.
- This will generate an instance of the development server where your app will be installed and displayed on the local machine. Usually the address is `http://127.0.0.1:5000/`. Copy that and paste it in the browser. <span style="color:#CC0000">**Do not use Ctrl+C, it will close the server. Right click and copy or just type the address.**</span> 
- This will show `Hello World` on a local webpage.

## Preparing the Model

Most of the steps for creating model are similar to the solution of a standard ML problem. We will skip those here, but the video will cover these steps in a bit more details. Once we have trained and fitted model ready we will export that model in a `pickle` file. This `pickle` will save the learned model and can be imported in directly without redoing the analysis.

### Stacked Model Generation

A Stacked model has two levels, the first level fits the standard models on the given training dataset. We will first follow our routine train and test. And then create a final visualization and model for export.

## Figures

The figure sizes have been customised so that you can easily put two images side-by-side. 

```{r, fig.show='hold'}
plot(1:10)
plot(10:1)
```

You can enable figure captions by `fig_caption: yes` in YAML:

    output:
      rmarkdown::html_vignette:
        fig_caption: yes

Then you can use the chunk option `fig.cap = "Your figure caption."` in **knitr**.

## More Examples

You can write math expressions, e.g. $Y = X\beta + \epsilon$, footnotes^[A footnote here.], and tables, e.g. using `knitr::kable()`.

```{r, echo=FALSE, results='asis'}
knitr::kable(head(mtcars, 10))
```

Also a quote using `>`:

> "He who gives up [code] safety for [code] speed deserves neither."
([via](https://twitter.com/hadleywickham/status/504368538874703872))
